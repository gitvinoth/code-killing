2025-10-04 09:40:49,774~|~Statistical_rules_v3~|~INFO~|~Creating statistical rules header...
2025-10-04 09:40:49,862~|~Statistical_rules_v3~|~ERROR~|~Error in create_statistical_rules_header(): [UNSUPPORTED_FEATURE.SET_OPERATION_ON_MAP_TYPE] The feature is not supported: Cannot have MAP type columns in DataFrame which calls set operations (INTERSECT, EXCEPT, etc.), but the type of column `conditions` is "ARRAY<STRUCT<condition_id: INT, condition_name: STRING, asset_id: ARRAY<STRING>, asset_parameters: MAP<STRING, ARRAY<STRING>>, join_condition: STRING, operator: STRING, class: INT, threshold: DOUBLE, duration: INT, wire: STRING, function: STRING, wireLengthFrom: INT, wireLengthTo: INT, rule_run_frequency: INT, sensor_type: STRING, severity: STRING, baseline_time: INT, threshold_unit: STRING, additional_properties: MAP<STRING, INT>, risk_register_controls: ARRAY<INT>, path: STRING>>". SQLSTATE: 0A000;
Deduplicate [conditions#10613, tenant_id#10611, rule_id#10608, join_condition#10612, rule_type#10610, operation#10614, rule_name#10609]
+- Filter NOT (operation#10614 = delete)
   +- LogicalRDD [rule_id#10608, rule_name#10609, rule_type#10610, tenant_id#10611, join_condition#10612, conditions#10613, operation#10614], false

[UNSUPPORTED_FEATURE.SET_OPERATION_ON_MAP_TYPE] The feature is not supported: Cannot have MAP type columns in DataFrame which calls set operations (INTERSECT, EXCEPT, etc.), but the type of column `conditions` is "ARRAY<STRUCT<condition_id: INT, condition_name: STRING, asset_id: ARRAY<STRING>, asset_parameters: MAP<STRING, ARRAY<STRING>>, join_condition: STRING, operator: STRING, class: INT, threshold: DOUBLE, duration: INT, wire: STRING, function: STRING, wireLengthFrom: INT, wireLengthTo: INT, rule_run_frequency: INT, sensor_type: STRING, severity: STRING, baseline_time: INT, threshold_unit: STRING, additional_properties: MAP<STRING, INT>, risk_register_controls: ARRAY<INT>, path: STRING>>". SQLSTATE: 0A000
